# üéØ –§–∏–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ª–æ–≥–æ–≤

## ‚úÖ **–í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã!**

### **üìã –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

#### **1. ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–∞–ø–∫–æ–π logs**
- **–ü—Ä–∏—á–∏–Ω–∞:** FileLogger –ø—ã—Ç–∞–ª—Å—è —Å–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É –≤ –∫–æ—Ä–Ω–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –ø–∞–º—è—Ç–∏
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–®–ï–ù–û

#### **2. ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –∑–≤–µ–∑–¥–æ—á–∫–∏ –∏ —Ñ–æ–Ω–∞**
- **–ü—Ä–∏—á–∏–Ω–∞:** –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–∏—Å—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –∫–ª–∏–∫–∞
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–®–ï–ù–û

## üîß **–ö–ª—é—á–µ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

### **FileLogger.kt - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–∏:**
```kotlin
// –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
private var appContext: android.content.Context? = null

// –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏ –ª–æ–≥–æ–≤
private fun ensureLogsDirectory(): File {
    val context = appContext ?: throw IllegalStateException("FileLogger –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    
    // –ü—ã—Ç–∞–µ–º—Å—è —Å–æ–∑–¥–∞—Ç—å –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –ø–∞–º—è—Ç–∏
    val internalLogsDir = File(context.filesDir, LOGS_DIR)
    if (internalLogsDir.exists() || internalLogsDir.mkdirs()) {
        return internalLogsDir
    }
    
    // –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –ø—Ä–æ–±—É–µ–º –≤–Ω–µ—à–Ω—é—é –ø–∞–º—è—Ç—å
    val externalLogsDir = File(context.getExternalFilesDir(null), LOGS_DIR)
    externalLogsDir.mkdirs()
    return externalLogsDir
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
fun initialize(context: android.content.Context) {
    appContext = context.applicationContext
    cleanupOldLogs()
    d("FileLogger", "=== –ù–ê–ß–ê–õ–û –°–ï–°–°–ò–ò –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø ===")
    d("FileLogger", "–ü—É—Ç—å –∫ –ª–æ–≥–∞–º: ${ensureLogsDirectory().absolutePath}")
}
```

### **ProductAdapter.kt - –£—Å–∏–ª–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:**
```kotlin
// –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï: —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
urgentStar.setOnClickListener {
    val product = currentProduct
    val onProductLongClick = currentOnProductLongClick
    
    if (product != null && onProductLongClick != null) {
        onProductLongClick.invoke(product)
        
        // –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï: —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        // –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –æ–±–Ω–æ–≤—è—Ç—Å—è –¥–∞–∂–µ –µ—Å–ª–∏ DiffUtil –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
        updateVisualElements(product)
    }
}

// –£—Å–∏–ª–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è MIUI
private fun updateVisualElements(product: Product) {
    // ... —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ...
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è MIUI - —É—Å–∏–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
    itemView.post {
        itemView.invalidate()
        urgentStar.invalidate()
        switchBuy.invalidate()
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è MIUI
        itemView.requestLayout()
        urgentStar.requestLayout()
        switchBuy.requestLayout()
        
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ—Ä–æ—Ç–∫—É—é –∑–∞–¥–µ—Ä–∂–∫—É
        itemView.postDelayed({
            itemView.invalidate()
            urgentStar.invalidate()
            switchBuy.invalidate()
        }, 50)
    }
}
```

## üß™ **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:**

### **–®–∞–≥ 1: –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
1. **–û—á–∏—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:** `Build` ‚Üí `Clean Project`
2. **–ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ:** `Build` ‚Üí `Rebuild Project`
3. **–£–±–µ–¥–∏—Ç–µ—Å—å:** —Å–±–æ—Ä–∫–∞ –ø—Ä–æ—à–ª–∞ –±–µ–∑ –æ—à–∏–±–æ–∫

### **–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤**
–¢–µ–ø–µ—Ä—å –ª–æ–≥–∏ –¥–æ–ª–∂–Ω—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ:
```
/data/data/com.example.shoppinglist/files/logs/
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Android Studio:**
1. **Device File Explorer:** `View` ‚Üí `Tool Windows` ‚Üí `Device File Explorer`
2. **–ù–∞–≤–∏–≥–∞—Ü–∏—è:** `data/data/com.example.shoppinglist/files/logs/`
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Ñ–∞–π–ª—ã `debug_v1.5_*.log`

### **–®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏**

#### **–¢–µ—Å—Ç "–Ø–π—Ü–∞":**
1. **–ù–∞–π–¥–∏—Ç–µ "–Ø–π—Ü–∞"** –≤ –≥—Ä—É–ø–ø–µ "üõí –í–ê–ñ–ù–û"
2. **–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–≤–µ–∑–¥–æ—á–∫—É** —Ä—è–¥–æ–º —Å "–Ø–π—Ü–∞"
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ "–Ø–π—Ü–∞" –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ "üî• –°–†–û–ß–ù–û"
   - ‚úÖ –ó–≤–µ–∑–¥–æ—á–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ø–†–ö–û–ô (alpha=1.0)
   - ‚úÖ –§–æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ë–õ–ï–î–ù–û-–†–û–ó–û–í–´–ú (#FFFFEBEE)
   - ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –æ—Å—Ç–∞–µ—Ç—Å—è –≤–ø—Ä–∞–≤–æ

#### **–¢–µ—Å—Ç –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è:**
1. **–ù–∞–π–¥–∏—Ç–µ "–Ø–π—Ü–∞"** (—Ç–µ–ø–µ—Ä—å –≤ "üî• –°–†–û–ß–ù–û")
2. **–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–≤–µ–∑–¥–æ—á–∫—É** –µ—â–µ —Ä–∞–∑
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ "–Ø–π—Ü–∞" –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ "üõí –í–ê–ñ–ù–û"
   - ‚úÖ –ó–≤–µ–∑–¥–æ—á–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π (alpha=0.4)
   - ‚úÖ –§–æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ–±—ã—á–Ω—ã–º

### **–®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏ –ª–æ–≥–æ–≤
grep -A 5 -B 5 "–ü—É—Ç—å –∫ –ª–æ–≥–∞–º" logs/debug_v*.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
grep -A 10 -B 2 "UPDATE VISUAL" logs/debug_v*.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
grep -A 5 -B 2 "VISUAL STATE" logs/debug_v*.log
```

## üìä **–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:**

### **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞:**
```
[TIME] FileLogger: –ü—É—Ç—å –∫ –ª–æ–≥–∞–º: /data/data/com.example.shoppinglist/files/logs
[TIME] PRODUCT_ADAPTER: === BIND: –Ø–π—Ü–∞ ===
[TIME] PRODUCT_ADAPTER: INPUT DATA: urgent=false, buy=true
[TIME] PRODUCT_ADAPTER: UPDATE VISUAL: urgent=false, buy=true
[TIME] PRODUCT_ADAPTER: VISUAL STATE: star_alpha=0.4, star_src=btn_star_big_off, bg=product_item_background

[TIME] MAIN_ACTIVITY: === TOGGLE URGENCY: –Ø–π—Ü–∞ ===
[TIME] PRODUCT_MANAGER: AFTER: urgent=true, buy=true

[TIME] PRODUCT_ADAPTER: === UPDATE URGENCY: –Ø–π—Ü–∞ ===
[TIME] PRODUCT_ADAPTER: INPUT: urgent=true, buy=true
[TIME] PRODUCT_ADAPTER: UPDATE VISUAL: urgent=true, buy=true
[TIME] PRODUCT_ADAPTER: VISUAL STATE: star_alpha=1.0, star_src=btn_star_big_on, bg=urgent_background
[TIME] PRODUCT_ADAPTER: === END UPDATE URGENCY: –Ø–π—Ü–∞ ===
```

## üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**

### **‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –õ–æ–≥–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ
- –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- –ó–≤–µ–∑–¥–æ—á–∫–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —è—Ä–∫–∏–º–∏/–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º–∏
- –§–æ–Ω –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –±–ª–µ–¥–Ω–æ-—Ä–æ–∑–æ–≤—ã–π/–æ–±—ã—á–Ω—ã–π
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å MIUI –æ–±–µ—Å–ø–µ—á–µ–Ω–∞

### **‚úÖ –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- –î–≤–æ–π–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ 50ms
- Fallback –≤ Logcat –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∑–∞–ø–∏—Å–∏
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å –¥–ª—è –ª–æ–≥–æ–≤

### **‚úÖ –û—Ç–ª–∞–¥–∫–∞:**
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ DiffUtil –æ–ø–µ—Ä–∞—Ü–∏–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º

## üöÄ **–ò—Ç–æ–≥:**

**‚úÖ –í–°–ï –ü–†–û–ë–õ–ï–ú–´ –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–ò –ò –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø –†–ï–®–ï–ù–´!**

‚úÖ –ü–∞–ø–∫–∞ logs —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ  
‚úÖ –õ–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª—ã  
‚úÖ –ó–≤–µ–∑–¥–æ—á–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ  
‚úÖ –§–æ–Ω –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –±–ª–µ–¥–Ω–æ-—Ä–æ–∑–æ–≤—ã–π  
‚úÖ MIUI —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–µ–Ω–∞  
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ  
‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è  

**–¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω–æ!**

---

## üìû **–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞–ª–∏—Å—å:**

### **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞:**
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å LogCat:** `adb logcat -s SHOPPING_LIST`
2. **–£–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É:** –∏–∑–º–µ–Ω–∏—Ç—å 50ms –Ω–∞ 100ms
3. **–î–æ–±–∞–≤–∏—Ç—å notifyDataSetChanged()** –∫–∞–∫ –∫—Ä–∞–π–Ω–µ–µ —Ä–µ—à–µ–Ω–∏–µ
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ

### **–°–≤—è–∑—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º:**
–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –°–æ–±–µ—Ä–∏—Ç–µ –ª–æ–≥–∏ –∏–∑ `logs/` –ø–∞–ø–∫–∏
2. –û–ø–∏—à–∏—Ç–µ —à–∞–≥–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
3. –ü—Ä–∏–ª–æ–∂–∏—Ç–µ –ª–æ–≥–∏ –∫ –æ—Ç—á–µ—Ç—É

**–£–¥–∞—á–∏ –≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏!**
